(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{324:function(t,a,s){"use strict";s.r(a);var n=s(13),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"兼容性问题及处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#兼容性问题及处理"}},[t._v("#")]),t._v(" 兼容性问题及处理")]),t._v(" "),a("h2",{attrs:{id:"导航栏"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#导航栏"}},[t._v("#")]),t._v(" 导航栏")]),t._v(" "),a("p",[t._v("​\t"),a("code",[t._v("uniapp")]),t._v("自带原生导航栏，在"),a("code",[t._v("pages.json")]),t._v("里配置。原生导航的体验更好，渲染新页面时，原生导航栏的渲染无需等待新页面"),a("code",[t._v("dom")]),t._v("加载，可以在新页面进入动画开始时就渲染。原生导航还可以避免滚动条通顶，并方便的控制原生下拉刷新。通过"),a("code",[t._v("pages.json")]),t._v("的配置，可以简单的、跨端的、高性能的开发业务。")]),t._v(" "),a("p",[t._v("​\t而且，在配置中配置原生导航栏，可以在导航栏上实现许多基础的功能拓展，比如搜索栏，自定义标签，自定义颜色，以及自定义按钮事件的绑定等功能，但是缺点也是显而易见，就是兼容性问题比较突出，因为纵使导航栏支持的配置满足业务，但是在"),a("code",[t._v("微信端")]),t._v("的原生导航栏提供的功能就寥寥无几了。往往编写的功能丰富的原生导航栏，在微信端都不能兼容。通过阅读官方文档，总结出如下方案。")]),t._v(" "),a("h4",{attrs:{id:"方案1-两版导航栏"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案1-两版导航栏"}},[t._v("#")]),t._v(" 方案1：两版导航栏")]),t._v(" "),a("ul",[a("li",[t._v("优点：在"),a("code",[t._v("APP-PLUS")]),t._v("兼容的端能利用好原生导航栏带来的性能优势。")]),t._v(" "),a("li",[t._v("缺点：需要使用"),a("code",[t._v("条件编译")]),t._v("来编写一版微信小程序端的自定义导航栏。")])]),t._v(" "),a("h4",{attrs:{id:"方案2-隐藏原生导航栏-自定义导航栏"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案2-隐藏原生导航栏-自定义导航栏"}},[t._v("#")]),t._v(" 方案2：隐藏原生导航栏，自定义导航栏")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("配置方法")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 部分页面隐藏原生导航栏")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"path"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"pages/address/index"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"style"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \t"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"navigationStyle"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"custom"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 全局隐藏原生导航栏")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"globalStyle"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"navigationStyle"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"custom"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("优点：编写一版导航栏，不需要进行多版导航栏维护。")])]),t._v(" "),a("li",[a("p",[t._v("缺点：微信小程序和小游戏右上角始终都有一个胶囊按钮，会遮挡自定义导航栏。")])])]),t._v(" "),a("blockquote",[a("p",[t._v("注意：使用自定义导航栏，在手机端会因为沉浸模式，导致页面顶部是贴近屏幕边缘而忽略了手机的状态栏的。")]),t._v(" "),a("p",[t._v("为了解决这个问题，需要对页面样式进行处理，使用CSS变量"),a("code",[t._v("var(--status-bar-height)")]),t._v("重新撑开状态栏的高度。")])]),t._v(" "),a("h2",{attrs:{id:"小程序组件会渲染出一个组件标签"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小程序组件会渲染出一个组件标签"}},[t._v("#")]),t._v(" 小程序组件会渲染出一个组件标签")]),t._v(" "),a("p",[t._v("问题：小程序自定义组件和APP/H5有差异，会多出一层组件标签的结构，需要注意样式的编写。")]),t._v(" "),a("p",[t._v("注意事项："),a("a",{attrs:{href:"https://uniapp.dcloud.io/matter.html#mp",target:"_blank",rel:"noopener noreferrer"}},[t._v("uniapp 小程序开发注意"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"slot默认插槽兼容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#slot默认插槽兼容"}},[t._v("#")]),t._v(" slot默认插槽兼容")]),t._v(" "),a("h4",{attrs:{id:"说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#说明"}},[t._v("#")]),t._v(" 说明：")]),t._v(" "),a("p",[t._v("​\t小程序没有默认插槽，只能使用命名插槽")]),t._v(" "),a("h4",{attrs:{id:"问题场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题场景"}},[t._v("#")]),t._v(" 问题场景：")]),t._v(" "),a("div",{staticClass:"language-vue extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[t._v("// card.vue\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t// 插槽\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("slot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("slot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("div",{staticClass:"language-vue extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[t._v("// cardlist.vue\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Card")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("我要插入插槽"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("Card")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h4",{attrs:{id:"渲染结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#渲染结果"}},[t._v("#")]),t._v(" 渲染结果：")]),t._v(" "),a("div",{staticClass:"language-vue extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[t._v("// 小程序渲染的结构\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("card")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" // ** 小程序会把组件也渲染成一层 **\n    \t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("card")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    // 错误：由于小程序无法找到对应的slot，只会在slot组件后面，增加一个view将slot填充，所以此处的展示为错位渲染了\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("我要插入插槽"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h4",{attrs:{id:"问题解决"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题解决"}},[t._v("#")]),t._v(" 问题解决：")]),t._v(" "),a("div",{staticClass:"language-vue extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[t._v("// card.vue\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t// 命名插槽，uniapp即可兼容小程序和h5插槽\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("slot")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("default"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("slot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("div",{staticClass:"language-vue extra-class"},[a("pre",{pre:!0,attrs:{class:"language-vue"}},[a("code",[t._v("// cardlist.vue\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Card")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("我要插入插槽"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("Card")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("view")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("h4",{attrs:{id:"问题原因分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题原因分析"}},[t._v("#")]),t._v(" 问题原因分析：")]),t._v(" "),a("blockquote",[a("p",[t._v("发生错位渲染结构分析：")]),t._v(" "),a("p",[t._v("由于小程序渲染组件时，无法找到对应的slot结构进行内容插入，所以把自定义组件中的内容，插入到自定义组件的后面的一个view结构中。")]),t._v(" "),a("p",[t._v("根本原因:")]),t._v(" "),a("p",[t._v("​\t小程序不支持非命名插槽，默认插槽命名为default")])]),t._v(" "),a("h2",{attrs:{id:"样式的动态绑定问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#样式的动态绑定问题"}},[t._v("#")]),t._v(" 样式的动态绑定问题")]),t._v(" "),a("h4",{attrs:{id:"问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[t._v("#")]),t._v(" 问题：")]),t._v(" "),a("ol",[a("li",[t._v("小程序端不支持 "),a("code",[t._v("classObject")]),t._v(" 和 "),a("code",[t._v("styleObject")]),t._v(" 语法。")]),t._v(" "),a("li",[t._v("不支持``模板字符串符号")])]),t._v(" "),a("h4",{attrs:{id:"解决"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决"}},[t._v("#")]),t._v(" 解决：")]),t._v(" "),a("p",[t._v("​\t使用字符串拼接")]),t._v(" "),a("h4",{attrs:{id:"相关文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#相关文档"}},[t._v("#")]),t._v(" 相关文档：")]),t._v(" "),a("p",[t._v("​\t"),a("a",{attrs:{href:"https://uniapp.dcloud.io/tutorial/vue-basics.html#class-%E4%B8%8E-style-%E7%BB%91%E5%AE%9A",target:"_blank",rel:"noopener noreferrer"}},[t._v("小程序端差异化的样式动态绑定"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);